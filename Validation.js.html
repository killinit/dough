<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: components/Validation.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"default":{"outputSourceFiles":true},"monospaceLinks":false,"cleverLinks":true,"applicationName":"Dough JavaScript","copyright":"Copyright Money Advice Service &copy;","linenums":true,"collapseSymbols":false};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">Dough JavaScript</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="module:Collapsable~Collapsable">
            <span class="title">
                <a href="module-Collapsable-Collapsable.html">module:Collapsable~Collapsable</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:Collapsable~Collapsable#_setupAccessibility"><a href="module-Collapsable-Collapsable.html#_setupAccessibility">_setupAccessibility</a></li>
            
                <li data-name="module:Collapsable~Collapsable#handleUIEventTracking"><a href="module-Collapsable-Collapsable.html#handleUIEventTracking">handleUIEventTracking</a></li>
            
                <li data-name="module:Collapsable~Collapsable#init"><a href="module-Collapsable-Collapsable.html#init">init</a></li>
            
                <li data-name="module:Collapsable~Collapsable#setListeners"><a href="module-Collapsable-Collapsable.html#setListeners">setListeners</a></li>
            
                <li data-name="module:Collapsable~Collapsable#setTargetTrackingListeners"><a href="module-Collapsable-Collapsable.html#setTargetTrackingListeners">setTargetTrackingListeners</a></li>
            
                <li data-name="module:Collapsable~Collapsable#toggle"><a href="module-Collapsable-Collapsable.html#toggle">toggle</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:DoughBaseComponent~DoughBaseComponent">
            <span class="title">
                <a href="module-DoughBaseComponent-DoughBaseComponent.html">module:DoughBaseComponent~DoughBaseComponent</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent.extend"><a href="module-DoughBaseComponent-DoughBaseComponent.html#extend">extend</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#_bindUiEvents"><a href="module-DoughBaseComponent-DoughBaseComponent.html#_bindUiEvents">_bindUiEvents</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#_initialisedFailure"><a href="module-DoughBaseComponent-DoughBaseComponent.html#_initialisedFailure">_initialisedFailure</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#_initialisedSuccess"><a href="module-DoughBaseComponent-DoughBaseComponent.html#_initialisedSuccess">_initialisedSuccess</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#_unbindUiEvents"><a href="module-DoughBaseComponent-DoughBaseComponent.html#_unbindUiEvents">_unbindUiEvents</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#destroy"><a href="module-DoughBaseComponent-DoughBaseComponent.html#destroy">destroy</a></li>
            
                <li data-name="module:DoughBaseComponent~DoughBaseComponent#setElement"><a href="module-DoughBaseComponent-DoughBaseComponent.html#setElement">setElement</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:FieldHelpText~FieldHelpText">
            <span class="title">
                <a href="module-FieldHelpText-FieldHelpText.html">module:FieldHelpText~FieldHelpText</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:FieldHelpText~FieldHelpText#_addAccessibility"><a href="module-FieldHelpText-FieldHelpText.html#_addAccessibility">_addAccessibility</a></li>
            
                <li data-name="module:FieldHelpText~FieldHelpText#_addListeners"><a href="module-FieldHelpText-FieldHelpText.html#_addListeners">_addListeners</a></li>
            
                <li data-name="module:FieldHelpText~FieldHelpText#_onBlur"><a href="module-FieldHelpText-FieldHelpText.html#_onBlur">_onBlur</a></li>
            
                <li data-name="module:FieldHelpText~FieldHelpText#hideTooltip"><a href="module-FieldHelpText-FieldHelpText.html#hideTooltip">hideTooltip</a></li>
            
                <li data-name="module:FieldHelpText~FieldHelpText#init"><a href="module-FieldHelpText-FieldHelpText.html#init">init</a></li>
            
                <li data-name="module:FieldHelpText~FieldHelpText#showTooltip"><a href="module-FieldHelpText-FieldHelpText.html#showTooltip">showTooltip</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:RangeInput~RangeInput">
            <span class="title">
                <a href="module-RangeInput-RangeInput.html">module:RangeInput~RangeInput</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:RangeInput~RangeInput#_cloneElements"><a href="module-RangeInput-RangeInput.html#_cloneElements">_cloneElements</a></li>
            
                <li data-name="module:RangeInput~RangeInput#_setupSyncInputs"><a href="module-RangeInput-RangeInput.html#_setupSyncInputs">_setupSyncInputs</a></li>
            
                <li data-name="module:RangeInput~RangeInput#init"><a href="module-RangeInput-RangeInput.html#init">init</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:TabSelector~TabSelector">
            <span class="title">
                <a href="module-TabSelector-TabSelector.html">module:TabSelector~TabSelector</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:TabSelector~TabSelector#_checkComponentMarkup"><a href="module-TabSelector-TabSelector.html#_checkComponentMarkup">_checkComponentMarkup</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_convertLinksToButtons"><a href="module-TabSelector-TabSelector.html#_convertLinksToButtons">_convertLinksToButtons</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_deSelectItem"><a href="module-TabSelector-TabSelector.html#_deSelectItem">_deSelectItem</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_focusTarget"><a href="module-TabSelector-TabSelector.html#_focusTarget">_focusTarget</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_handleClickEvent"><a href="module-TabSelector-TabSelector.html#_handleClickEvent">_handleClickEvent</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_haveTriggersWrapped"><a href="module-TabSelector-TabSelector.html#_haveTriggersWrapped">_haveTriggersWrapped</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_positionMenu"><a href="module-TabSelector-TabSelector.html#_positionMenu">_positionMenu</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_setTriggerWrapperHeight"><a href="module-TabSelector-TabSelector.html#_setTriggerWrapperHeight">_setTriggerWrapperHeight</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_setupAccessibility"><a href="module-TabSelector-TabSelector.html#_setupAccessibility">_setupAccessibility</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_subscribeHubEvents"><a href="module-TabSelector-TabSelector.html#_subscribeHubEvents">_subscribeHubEvents</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_toggleMenu"><a href="module-TabSelector-TabSelector.html#_toggleMenu">_toggleMenu</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_updateCollapsedState"><a href="module-TabSelector-TabSelector.html#_updateCollapsedState">_updateCollapsedState</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_updateTargets"><a href="module-TabSelector-TabSelector.html#_updateTargets">_updateTargets</a></li>
            
                <li data-name="module:TabSelector~TabSelector#_updateTriggers"><a href="module-TabSelector-TabSelector.html#_updateTriggers">_updateTriggers</a></li>
            
                <li data-name="module:TabSelector~TabSelector#init"><a href="module-TabSelector-TabSelector.html#init">init</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:TabularTooltip~TabularTooltip">
            <span class="title">
                <a href="module-TabularTooltip-TabularTooltip.html">module:TabularTooltip~TabularTooltip</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:TabularTooltip~TabularTooltip#init"><a href="module-TabularTooltip-TabularTooltip.html#init">init</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="module:Validation~Validation">
            <span class="title">
                <a href="module-Validation-Validation.html">module:Validation~Validation</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module:Validation~Validation#_addAccessibility"><a href="module-Validation-Validation.html#_addAccessibility">_addAccessibility</a></li>
            
                <li data-name="module:Validation~Validation#_getErrorIndexByName"><a href="module-Validation-Validation.html#_getErrorIndexByName">_getErrorIndexByName</a></li>
            
                <li data-name="module:Validation~Validation#_getFieldGroup"><a href="module-Validation-Validation.html#_getFieldGroup">_getFieldGroup</a></li>
            
                <li data-name="module:Validation~Validation#_getFieldGroupValidity"><a href="module-Validation-Validation.html#_getFieldGroupValidity">_getFieldGroupValidity</a></li>
            
                <li data-name="module:Validation~Validation#_getInlineErrorID"><a href="module-Validation-Validation.html#_getInlineErrorID">_getInlineErrorID</a></li>
            
                <li data-name="module:Validation~Validation#_handleBlurEvent"><a href="module-Validation-Validation.html#_handleBlurEvent">_handleBlurEvent</a></li>
            
                <li data-name="module:Validation~Validation#_handleChangeEvent"><a href="module-Validation-Validation.html#_handleChangeEvent">_handleChangeEvent</a></li>
            
                <li data-name="module:Validation~Validation#_handleSubmit"><a href="module-Validation-Validation.html#_handleSubmit">_handleSubmit</a></li>
            
                <li data-name="module:Validation~Validation#_hideValidationSummary"><a href="module-Validation-Validation.html#_hideValidationSummary">_hideValidationSummary</a></li>
            
                <li data-name="module:Validation~Validation#_prepareFieldGroupValidity"><a href="module-Validation-Validation.html#_prepareFieldGroupValidity">_prepareFieldGroupValidity</a></li>
            
                <li data-name="module:Validation~Validation#_prepareMarkup"><a href="module-Validation-Validation.html#_prepareMarkup">_prepareMarkup</a></li>
            
                <li data-name="module:Validation~Validation#_removeAccessibility"><a href="module-Validation-Validation.html#_removeAccessibility">_removeAccessibility</a></li>
            
                <li data-name="module:Validation~Validation#_showValidationSummary"><a href="module-Validation-Validation.html#_showValidationSummary">_showValidationSummary</a></li>
            
                <li data-name="module:Validation~Validation#_sortErrorsByFieldDisplayOrder"><a href="module-Validation-Validation.html#_sortErrorsByFieldDisplayOrder">_sortErrorsByFieldDisplayOrder</a></li>
            
                <li data-name="module:Validation~Validation#_validateMax"><a href="module-Validation-Validation.html#_validateMax">_validateMax</a></li>
            
                <li data-name="module:Validation~Validation#_validateMin"><a href="module-Validation-Validation.html#_validateMin">_validateMin</a></li>
            
                <li data-name="module:Validation~Validation#_validateMinLength"><a href="module-Validation-Validation.html#_validateMinLength">_validateMinLength</a></li>
            
                <li data-name="module:Validation~Validation#_validatePattern"><a href="module-Validation-Validation.html#_validatePattern">_validatePattern</a></li>
            
                <li data-name="module:Validation~Validation#_validateRequired"><a href="module-Validation-Validation.html#_validateRequired">_validateRequired</a></li>
            
                <li data-name="module:Validation~Validation#addError"><a href="module-Validation-Validation.html#addError">addError</a></li>
            
                <li data-name="module:Validation~Validation#checkfieldGroupValidity"><a href="module-Validation-Validation.html#checkfieldGroupValidity">checkfieldGroupValidity</a></li>
            
                <li data-name="module:Validation~Validation#refreshInlineErrors"><a href="module-Validation-Validation.html#refreshInlineErrors">refreshInlineErrors</a></li>
            
                <li data-name="module:Validation~Validation#refreshValidationSummary"><a href="module-Validation-Validation.html#refreshValidationSummary">refreshValidationSummary</a></li>
            
                <li data-name="module:Validation~Validation#removeError"><a href="module-Validation-Validation.html#removeError">removeError</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Validation.js.html">Source: components/Validation.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @description Client side validation. Mirrors HTML5 validation API as much as possible.
 * Supported types are:
 * - `required`
 * - `minlength`
 * - `pattern`
 * - `min|max` number range checking
 *
 * @module Validation
 * @returns {class} Validation
 */
define(['jquery', 'DoughBaseComponent'], function($, DoughBaseComponent) {
  'use strict';

  var defaultConfig = {
        fieldSelector: 'input, textarea, select',
        attributeEmpty: 'data-dough-validation-empty',
        attributeInvalid: 'data-dough-validation-invalid',
        rowInvalidClass: 'is-errored',
        validationSummaryClass: 'validation-summary',
        validationSummaryListAttribute: 'data-dough-validation-summary-list',
        validationSummaryHiddenClass: 'validation-summary--hidden',
        validationSummaryErrorClass: 'validation-summary__error',
        inlineErrorClass: 'js-inline-error',
        uiEvents: {
          'blur input, select, textarea': '_handleBlurEvent',
          'keyup input, textarea': '_handleChangeEvent',
          'change input, select': '_handleChangeEvent',
          'submit': '_handleSubmit'
        }
      },
      Validation;

  /**
   * Call base constructor
   * @constructor
   * @extends {DoughBaseComponent}
   */
  Validation = function($el, config) {
    Validation.baseConstructor.call(this, $el, config, defaultConfig);
  };

  DoughBaseComponent.extend(Validation);

  Validation.prototype.init = function(initialised) {
    this.ATTRIBUTE_VALIDATORS = {
      'required': '_validateRequired',
      'pattern': '_validatePattern',
      'min': '_validateMin',
      'max': '_validateMax',
      'minlength': '_validateMinLength'
    };

    // If there's server erros on the page, we back off completely
    // There are a number of different types of errors that the server
    // generates, and this file will grow in complexity trying to keep up.
    if (this.$el.find('[' + this.config.validationSummaryListAttribute + ']').find('li').length > 0) {
      this._unbindUiEvents();
      this.enabled = false;
      return this;
    }

    this.$allFieldsOnPage = this.$el.find(this.config.fieldSelector);
    this.errors = [];
    this._prepareMarkup();

    this.enabled = true;

    this._initialisedSuccess(initialised);
    return this;
  };

  /**
   * Register an error, to be used with both inline and validation summary
   * @param {Object} fieldGroupValidity The validity object generated by _getfieldGroupValidity()
   * @return {Validation}        Class instance
   */
  Validation.prototype.addError = function(fieldGroupValidity) {
    var existingErrorIndex = this._getErrorIndexByName(fieldGroupValidity.name);

    if (existingErrorIndex !== -1) {
      this.errors.splice(existingErrorIndex, 1);
    }

    this.errors.push(fieldGroupValidity);

    this._addAccessibility(fieldGroupValidity.$fieldGroup);
    this._sortErrorsByFieldDisplayOrder().refreshInlineErrors().refreshValidationSummary();

    return this;
  };

  /**
   * Remove an error
   * @param  {Object} fieldGroupValidity Field Validity Object
   * @return {Validation}        Class instance
   */
  Validation.prototype.removeError = function(fieldGroupValidity) {
    var existingErrorIndex = this._getErrorIndexByName(fieldGroupValidity.name);
    if (existingErrorIndex !== -1) {
      this.errors.splice(existingErrorIndex, 1);
    }

    this._removeAccessibility(fieldGroupValidity.$fieldGroup);
    this._sortErrorsByFieldDisplayOrder().refreshInlineErrors().refreshValidationSummary();

    return this;
  };

  /**
   * Refresh all the inline error messages
   * @return {Validation} Class instance
   */
  Validation.prototype.refreshInlineErrors = function() {
    this.$el.find('.form__row').each($.proxy(function(i, o) {
      var $formRow = $(o),
          $errorContainer = $formRow.find('.' + this.config.inlineErrorClass),
          $inputs = $formRow.find(this.config.fieldSelector),
          errorHTML = "",
          rowHasErrors = false,
          groupsDealtWith = [];

      $inputs.each($.proxy(function(_i, _o) {
        var $input = $(_o),
            inputName = $input.attr('name'),
            errorIndex = this._getErrorIndexByName(inputName);

        if (errorIndex > -1 &amp;&amp; $.inArray(inputName, groupsDealtWith) === -1) {
          rowHasErrors = true;
          groupsDealtWith.push(inputName);
          errorHTML += '&lt;p id="' + this._getInlineErrorID(inputName) + '" class="' + this.config.validationSummaryErrorClass + '">' + (errorIndex + 1) + '. ' + this.errors[errorIndex].message + '&lt;/p>';
        }
      }, this));

      if (rowHasErrors) {
        $formRow.addClass(this.config.rowInvalidClass);
      }
      else {
        $formRow.removeClass(this.config.rowInvalidClass);
      }

      $errorContainer.html(errorHTML);

    }, this));

    return this;
  };

  /**
   * Loop through the errors and build the summary markup
   * @return {Validation} Class instance
   */
  Validation.prototype.refreshValidationSummary = function() {
    var fieldName,
        fieldGroupValidity,
        summaryHTML = '';

    $.each(this.errors, $.proxy(function(errorIndex, fieldGroupValidity) {
      fieldName = fieldGroupValidity.name;
      summaryHTML += '&lt;li class="' + this.config.validationSummaryErrorClass + '">&lt;a href="#' + this._getInlineErrorID(fieldName) + '">' + fieldGroupValidity.message + '&lt;/a>&lt;/li>';
    }, this));

    this.$el.find('[' + this.config.validationSummaryListAttribute + ']').html(summaryHTML);

    if (this.errors.length &lt; 1) {
      this._hideValidationSummary();
    }

    return this;
  };

  /**
   * Check a field's validity and update the errors array
   * @param  {jQuery} $field The field to validate
   * @return {Validation}        Class instance
   */
  Validation.prototype.checkfieldGroupValidity = function($field) {
    var $fieldGroup = this._getFieldGroup($field),
        fieldGroupValidity = this._getFieldGroupValidity($fieldGroup);

    if (fieldGroupValidity.hasError) {
      this.addError(fieldGroupValidity);
    }
    else {
      this.removeError(fieldGroupValidity);
    }

    return this;
  };

  /**
   * Prepare the markup for both inline errors and the validation summary
   *
   * This will check to see if there's an inline error block rendered by the server
   * (in case it's picked up errors we don't support)
   *
   * It will also generate a fallback list if the server hasn't been configured.
   *
   * @return {type} [description]
   */
  Validation.prototype._prepareMarkup = function() {
    var $validationSummary = this.$el.find('.' + this.config.validationSummaryClass);
    if (!$validationSummary.length) {
      this.$el.prepend('&lt;div class="' + this.config.validationSummaryClass + ' ' + this.config.validationSummaryHiddenClass + '">\
          &lt;ol ' + this.config.validationSummaryListAttribute + '>&lt;/ol>\
        &lt;/div>');
    }

    this.$el.find('.form__row').each($.proxy(function(i, o) {
      var $formRow = $(o),
          $existingInlineErrors = $formRow.find('.' + this.config.inlineErrorClass);

      if (!$existingInlineErrors.length) {
        $formRow.prepend($('&lt;div class="' + this.config.inlineErrorClass + '" />'));
      }
    }, this));

    return this;
  };

  /**
   * Generate the ID to be used with the inline error blocks
   * These are used for the validation summary deeplinks, and
   * for the aria-describedby property on the field.
   *
   * @param  {String} fieldName The field name
   * @return {String}         The inline error ID
   */
  Validation.prototype._getInlineErrorID = function(fieldName) {
    var formID = this.$el.attr('id');
    return 'error-' + (formID ? formID + '-' : '') + fieldName;
  };

  /**
   * Add the accessibility attributes to an invalid field
   * @param {jQuery} $fieldGroup jQuery field
   * @return {Validation}  Class instance
   */
  Validation.prototype._addAccessibility = function($fieldGroup) {
    $fieldGroup.each($.proxy(function(i, field) {
      var $field = $(field),
          existingDescribedBy = $field.attr('aria-describedby') || '',
          inlineErrorID = this._getInlineErrorID($field.attr('name'));

      $field.attr('aria-invalid', 'true');

      if ($.inArray(inlineErrorID, existingDescribedBy) === -1) {
        $field.attr('aria-describedby', existingDescribedBy + ' ' + inlineErrorID);
      }
    }, this));

    return this;
  };

  /**
   * Remove aria attributes for a valid field
   * @param  {type} $fieldGroup [description]
   * @return {type}               [description]
   */
  Validation.prototype._removeAccessibility = function($fieldGroup) {
    $fieldGroup.each($.proxy(function(i, field) {
      var $field = $(field),
          existingDescribedBy = $field.attr('aria-describedby') || '',
          inlineErrorID = this._getInlineErrorID($field.attr('name'));

      $field.removeAttr('aria-invalid');
      $field.attr('aria-describedby', existingDescribedBy.replace(inlineErrorID, ''));
    }, this));

    return this;
  };

  /**
   * Show the validation summary;
   *
   * @return {type} [description]
   */
  Validation.prototype._showValidationSummary = function() {
    this.$el.find('.' + this.config.validationSummaryClass).removeClass(this.config.validationSummaryHiddenClass);
    return this;
  };

  /**
   * Hide the validation summary;
   *
   * @return {type} [description]
   */
  Validation.prototype._hideValidationSummary = function() {
    this.$el.find('.' + this.config.validationSummaryClass).addClass(this.config.validationSummaryHiddenClass);
    return this;
  };

  /**
   * Check a field group's validity
   * For required fields, only ONE element in the group needs a value
   *
   * @param  {jQuery} $fieldGroup The field group to validate (grouped by 'name' attribute)
   * @return {Object}        A hash containing status and the appropriate error message
   */
  Validation.prototype._getFieldGroupValidity = function($fieldGroup) {
    var $primaryField = $fieldGroup.first(),
        fieldGroupValidity = {
          errors: [],
          isEmpty: true,
          isInvalid: false,
          hasError: false,
          message: '',
          name: $primaryField.attr('name'),
          $fieldGroup: $fieldGroup
        };

    // Populate the field validity with an array of results from the various validators
    $.each(this.ATTRIBUTE_VALIDATORS, $.proxy(function(attributeSelector, handler) {
      $fieldGroup.each($.proxy(function(_fieldIndex, field) {
        var $field = $(field),
            attr = $field.attr(attributeSelector);

        if (attr) {
          fieldGroupValidity.errors.push(this[handler]($field, $field.val(), attr));
        }
      }, this));
    }, this));

    return this._prepareFieldGroupValidity($primaryField, fieldGroupValidity);
  };

  /**
   * Make the fieldValidity object useful by hoisting up
   * various properties from the individual validators
   *
   * @param  {jQuery} $primaryField      The primary field of the group (usually the first)
   * @param  {Object} fieldGroupValidity Validity object including results of the validators
   * @return {Object}                    fieldGroupValidity with normalised states for display
   */
  Validation.prototype._prepareFieldGroupValidity = function($primaryField, fieldGroupValidity) {
    // Hoist up to top level for ease of access
    $.each(fieldGroupValidity.errors, function(i, validatorResults) {
      if (validatorResults.name == "required" &amp;&amp; validatorResults.isEmpty !== true) {
        fieldGroupValidity.isEmpty = false;
      }

      if (validatorResults.isInvalid) {
        fieldGroupValidity.isInvalid = true;
      }
    });

    fieldGroupValidity.hasError = fieldGroupValidity.errors.length &amp;&amp; (fieldGroupValidity.isEmpty || fieldGroupValidity.isInvalid);

    // Check which message to use, empty should take prescedence
    if (fieldGroupValidity.isInvalid) {
      fieldGroupValidity.message = $primaryField.attr(this.config.attributeInvalid) || $primaryField.attr(this.config.attributeEmpty);
    }

    if (fieldGroupValidity.isEmpty) {
      fieldGroupValidity.message = $primaryField.attr(this.config.attributeEmpty);
    }

    return fieldGroupValidity;
  };


  /**
   * Basic required field validator, for non-empty
   *
   * @param  {jQuery} $field   the field being checked
   * @param  {String} value    the field value
   * @param  {String} required Validation parameters
   * @return {Object}          Validity object
   */
  Validation.prototype._validateRequired = function($field, value, required) {
    var validity = { name: 'required' };

    if ($field.is('[type="radio"]') &amp;&amp; !$field.prop('checked')) {
      validity.isEmpty = true;
    }
    else {
      if (value == '') {
        validity.isEmpty = true;
      }
    }

    return validity;
  };

  /**
   * Regular expression validator
   *
   * @param  {jQuery} $field   the field being checked
   * @param  {String} value    the field value
   * @param  {String} pattern Validation parameters
   * @return {Object}          Validity object
   */
  Validation.prototype._validatePattern = function($field, value, pattern) {
    var validity = { name: 'pattern' };
    if (!value.match(pattern)) {
      validity.isInvalid = true;
    }

    return validity;
  };

  /**
   * Check a number is above the minimum
   *
   * @param  {jQuery} $field   the field being checked
   * @param  {String} value    the field value
   * @param  {String} min Validation parameters
   * @return {Object}          Validity object
   */
  Validation.prototype._validateMin = function($field, value, min) {
    var validity = { name: 'min' },
        valueAsNumber = Number(value);

    if (isNaN(valueAsNumber) || valueAsNumber &lt; min) {
      validity.isInvalid = true;
    }

    return validity;
  };

  /**
   * Check a number is below the maximum
   *
   * @param  {jQuery} $field   the field being checked
   * @param  {String} value    the field value
   * @param  {String} max Validation parameters
   * @return {Object}          Validity object
   */
  Validation.prototype._validateMax = function($field, value, max) {
    var validity = { name: 'max' },
        valueAsNumber = Number(value);

    if (isNaN(valueAsNumber) || valueAsNumber > max) {
      validity.isInvalid = true;
    }

    return validity;
  };

  /**
   * Ensure a minimum number of characters
   *
   * @param  {jQuery} $field   the field being checked
   * @param  {String} value    the field value
   * @param  {String} minlength Validation parameters
   * @return {Object}          Validity object
   */
  Validation.prototype._validateMinLength = function($field, value, minlength) {
    var validity = { name: 'minlength' };
    // Check for more than 0 otherwise we clash with 'isEmpty'
    if (value.length > 0 &amp;&amp; value.length &lt; minlength) {
      validity.isInvalid = true;
    }

    return validity;
  };

  /**
   * Get the index in the error array according to the field group name
   *
   * @param  {String} fieldName Field name
   * @return {Integer}    Index in errors array
   */
  Validation.prototype._getErrorIndexByName = function(fieldName) {
    var matchedErrorIndex = -1;
    $.each(this.errors, $.proxy(function(index, fieldGroupValidity) {
      var _fieldName = fieldGroupValidity.name;
      if (_fieldName === fieldName) {
        matchedErrorIndex = index;
        return;
      }
    }, this));

    return matchedErrorIndex;
  };

  /**
   * Sort the errors so they are in line with the order the fields are displayed on the page
   * regardless of the order they were 'created'
   *
   * If the user fills in the form bottom-to-top, then the first error will still be the
   * first field on the page.
   *
   * @return {Validation} Class Instance
   */
  Validation.prototype._sortErrorsByFieldDisplayOrder = function() {
    var sortedErrors = [],
        groupsDealtWith = [];

    this.$allFieldsOnPage.each($.proxy(function(i, o) {
      var $field = $(o),
          fieldName = $field.attr('name'),
          fieldErrorIndex = this._getErrorIndexByName(fieldName);

      if (fieldErrorIndex !== -1 &amp;&amp; $.inArray(fieldName, groupsDealtWith) === -1) {
        sortedErrors.push(this.errors[fieldErrorIndex]);
        groupsDealtWith.push(fieldName);
      }
    }, this));

    this.errors = sortedErrors;
    return this;
  };

  /**
   * Look for all fields with the same name, and validate
   * as a group.
   * Typical use case for this is radio/checkboxes.
   *
   * @param  {jQuery} $field jQuery field
   * @return {jQuery}        jQuery fieldgroup, array of fields with matching name
   */
  Validation.prototype._getFieldGroup = function($field) {
    var $fieldGroup,
        fieldName = $field.attr('name');

    return this.$allFieldsOnPage.filter('[name="' + fieldName + '"]');
  };

  /**
   * Inline errors are shown on input blur
   *
   * @param  {Event} e BlurEvent
   * @return {void}
   */
  Validation.prototype._handleBlurEvent = function(e) {
    this.checkfieldGroupValidity($(e.target));
  };

  /**
   * Error messages get corrected as the user types. Only do this if we can see an error exists.
   *
   * @param  {Object} e ChangeEvent
   * @return {void}
   */
  Validation.prototype._handleChangeEvent = function(e) {
    var $field = $(e.target);

    if (this._getErrorIndexByName($field.attr('name')) > -1) {
      this.checkfieldGroupValidity($field);
    }
  };

  /**
   * The validation summary is updated on form submit
   *
   * @return {void}
   */
  Validation.prototype._handleSubmit = function(e) {
    this.$allFieldsOnPage.each($.proxy(function(i, field) {
      this.checkfieldGroupValidity($(field));
    }, this));

    if (this.errors.length) {
      e.preventDefault();
      this._sortErrorsByFieldDisplayOrder().refreshValidationSummary()._showValidationSummary();
    }
  };


  return Validation;

});
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Thu May 07 2015 10:18:46 GMT+0100 (BST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
